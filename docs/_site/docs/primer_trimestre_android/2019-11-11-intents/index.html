<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><title>Intents y filtros de intents - PMD_19-20</title><link rel="shortcut icon" href="http://localhost:4000/PMD_19-20/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="http://localhost:4000/PMD_19-20/assets/css/just-the-docs.css"> <script type="text/javascript" src="http://localhost:4000/PMD_19-20/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/PMD_19-20/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Intents y filtros de intents | PMD_19-20</title><meta name="generator" content="Jekyll v3.8.6" /><meta property="og:title" content="Intents y filtros de intents" /><meta property="og:locale" content="en_US" /><meta name="description" content="Programación multimedia y dispositivos móviles" /><meta property="og:description" content="Programación multimedia y dispositivos móviles" /><link rel="canonical" href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-11-11-intents/" /><meta property="og:url" content="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-11-11-intents/" /><meta property="og:site_name" content="PMD_19-20" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-11-11T13:30:00+01:00" /> <script type="application/ld+json"> {"@type":"BlogPosting","headline":"Intents y filtros de intents","dateModified":"2019-11-11T13:30:00+01:00","url":"http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-11-11-intents/","datePublished":"2019-11-11T13:30:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-11-11-intents/"},"description":"Programación multimedia y dispositivos móviles","@context":"https://schema.org"}</script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"><title>Link</title><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg><div class="page-wrap"><div class="side-bar"><div class="site-header"> <a href="http://localhost:4000/PMD_19-20" class="site-title lh-tight"> PMD_19-20 </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button></div><div class="navigation main-nav js-main-nav"><nav role="navigation" aria-label="Main navigation"><ul class="navigation-list"><li class="navigation-list-item"><a href="http://localhost:4000/PMD_19-20/docs/segundo_trimestre_android/2019-12-01-servicios-hilos/" class="navigation-list-link">Servicios e hilos</a><li class="navigation-list-item"><a href="http://localhost:4000/PMD_19-20/docs/segundo_trimestre_android/2019-12-03-asynctask/" class="navigation-list-link">AsyncTask</a><li class="navigation-list-item"><a href="http://localhost:4000/PMD_19-20/docs/segundo_trimestre_android/2019-12-05-notificaciones/" class="navigation-list-link">Notificaciones</a><li class="navigation-list-item"><a href="http://localhost:4000/PMD_19-20/docs/segundo_trimestre_android/2019-12-12-ficheros/" class="navigation-list-link">Lectura fichero directorio raw</a><li class="navigation-list-item"><a href="http://localhost:4000/PMD_19-20/docs/segundo_trimestre_android/2019-12-17-Alarmas/" class="navigation-list-link">Alarmas</a><li class="navigation-list-item active"><a href="http://localhost:4000/PMD_19-20/" class="navigation-list-link"></a><li class="navigation-list-item active"><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android" class="navigation-list-link">Primer trimestre Android</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-09-25-primera-aplicacion/" class="navigation-list-link">Primera aplicación</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-09-26-metodo-findviewbyid/" class="navigation-list-link">Método FindViewByID</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-10-02-manifest/" class="navigation-list-link">Fichero Manifest</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-10-04-ejemplo_radio_check/" class="navigation-list-link">Ejemplo RadioButton y Checkbox</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-10-09-multi-idioma/" class="navigation-list-link">Compatibilidad entre distintos idiomas</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-10-09-switch-imageview/" class="navigation-list-link">Ejemplo Switch e ImageView</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-10-16-layout/" class="navigation-list-link">Layouts</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-10-17-recorrido-contenedor/" class="navigation-list-link">Recorrido de un TableLayout</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-10-18-ejemplo-fragment/" class="navigation-list-link">Ejemplo sencillo de Fragment</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-10-21-dialogos/" class="navigation-list-link">Diálogos</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-10-28-recyclerView/" class="navigation-list-link">RecyclerView</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-11-06-actionbar/" class="navigation-list-link">Action Bar</a><li class="navigation-list-item active"><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-11-11-intents/" class="navigation-list-link active">Intents y filtros de intents</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-11-13-permisos/" class="navigation-list-link">Permisos</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-11-18-broadcastreceiver/" class="navigation-list-link">Broadcast Receiver y SMS</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-11-19-content-provider/" class="navigation-list-link">Content providers y acceso a los contactos</a><li class="navigation-list-item "><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android/2019-11-24-sqlite/" class="navigation-list-link">SQLite</a></ul><li class="navigation-list-item"><a href="http://localhost:4000/PMD_19-20/docs/segundo_trimestre_android" class="navigation-list-link">Segundo trimestre Android</a><ul class="navigation-list-child-list "></ul></ul></nav></div><footer class="site-footer"><p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p></footer></div><div class="main-content-wrap js-main-content" tabindex="0"><div class="main-content"><div class="page-header js-page-header"><div class="search"><div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search PMD_19-20" aria-label="Search PMD_19-20" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg></div><div class="js-search-results search-results-wrap"></div></div><ul class="list-style-none text-small aux-nav"><li class="d-inline-block my-0"><a href="https://github.com/Manuel-Ag/PMD_19-20">GitHub</a></ul></div><div class="page"><nav class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/PMD_19-20/docs/primer_trimestre_android">Primer trimestre Android</a><li class="breadcrumb-nav-list-item"><span>Intents y filtros de intents</span></ol></nav><div id="main-content" class="page-content" role="main"><h1 id="intents-y-filtros-de-intents"> <a href="#intents-y-filtros-de-intents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Intents y filtros de intents</h1><p><strong>Antes de nada, visita los siguientes enlaces:</strong></p><ul><li>Intents y filtros de intents: <a href="https://developer.android.com/guide/components/intents-filters.html?hl=es">https://developer.android.com/guide/components/intents-filters.html?hl=es</a><li>Documentación de la clase Intent: <a href="https://developer.android.com/reference/android/content/Intent">https://developer.android.com/reference/android/content/Intent</a></ul><h1 id="intents"> <a href="#intents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Intents</h1><p>El primer proyecto que comentaremos es el relativo a envío de intents, tanto implícitos como explícitos. Proyecto: <a href="https://github.com/Manuel-Ag/PMD_19-20/tree/master/Intents">https://github.com/Manuel-Ag/PMD_19-20/tree/master/Intents</a>.</p><p style="text-align: center;"><img src="/PMD_19-20/assets/img_post_intents/captura1.jpg" alt="Android" /></p><p>En este proyecto dividiremos los ejemplos en diferentes botones:</p><ul><li>Botón <code class="highlighter-rouge">Intent explícito</code>: El primer intent lo utilizamos únicamente para lanzar otra actividad, sin ninguna otra funcionalidad.</ul><figure class="highlight"><pre><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">botonIntentExplicito</span><span class="o">(</span><span class="nc">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Creamos el intent</span>
        <span class="nc">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Intent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="nc">Actividad2</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="c1">// Lanzamos la segunda actividad</span>
        <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
    <span class="o">}</span></code></pre></figure><p>Creamos el intent explícito y se envía el intent cuando se llama al método <code class="highlighter-rouge">startActivity()</code>. Este método enviará el intent a la actividad definida.</p><ul><li>Botón <code class="highlighter-rouge">Intent con putExtra()</code>: Podemos enviar información adjunta al intent. Simplemente debemos especificar un identificador al campo y la información.</ul><figure class="highlight"><pre><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">botonIntentExplicitoPutExtra</span><span class="o">(</span><span class="nc">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Creamos el intent</span>
        <span class="nc">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Intent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="nc">Actividad2</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="c1">// Llamamos a putExtra()</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="s">"tag1"</span><span class="o">,</span> <span class="s">"Contenido intent(1)"</span><span class="o">);</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="s">"tag2"</span><span class="o">,</span> <span class="s">"Contenido intent(2)"</span><span class="o">);</span>
        <span class="c1">// Lanzamos la segunda actividad</span>
        <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
    <span class="o">}</span></code></pre></figure><p>Para recuperar esa información en la actividad receptora, se recupera el intent enviado y se hace referencia a sus identificadores con el método <code class="highlighter-rouge">get()</code> correspondiente:</p><figure class="highlight"><pre><code class="language-java" data-lang="java">        <span class="c1">// Recupero el intent que ha lanzado esta actividad</span>
        <span class="nc">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="n">getIntent</span><span class="o">();</span>
        <span class="c1">// Y su contenido</span>
        <span class="nc">String</span> <span class="n">tag1</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getStringExtra</span><span class="o">(</span><span class="s">"tag1"</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">tag2</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getStringExtra</span><span class="o">(</span><span class="s">"tag2"</span><span class="o">);</span></code></pre></figure><ul><li>Botón <code class="highlighter-rouge">Intent con respuesta</code>: Cuando abrimos una actividad y esperamos una respuesta de esta, debemos de implementar algunos métodos más. Primero, el método que lanza el intent cambia a <code class="highlighter-rouge">startActivityForResult()</code>. Además, en este caso <code class="highlighter-rouge">OPCION1</code> identifica al intent, lo cuál lo comprobaremos en la respuesta.</ul><figure class="highlight"><pre><code class="language-java" data-lang="java">        <span class="nc">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Intent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="nc">Actividad2</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">startActivityForResult</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="no">OPCION1</span><span class="o">);</span></code></pre></figure><p>En la segunda actividad creada, se debe responder con:</p><figure class="highlight"><pre><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">botonAceptar</span><span class="o">(</span><span class="nc">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Intent</span><span class="o">();</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="s">"tag3"</span><span class="o">,</span> <span class="s">"Hola"</span><span class="o">);</span>
        <span class="c1">// Enviamos el intent al MainActivity.class y cerramos la actividad actual</span>
        <span class="n">setResult</span><span class="o">(</span><span class="no">RESULT_OK</span><span class="o">,</span> <span class="n">intent</span><span class="o">);</span>
        <span class="n">finish</span><span class="o">();</span>
    <span class="o">}</span></code></pre></figure><p>El método <code class="highlighter-rouge">setResult()</code> envía el intent y el método <code class="highlighter-rouge">finish()</code> finaliza la actividad actual. <code class="highlighter-rouge">setResult()</code> tiene otro parámetro que indica si el código de respuesta es <code class="highlighter-rouge">RESULT_OK</code> u otro, el cuál podremos conocer en la primera actividad.</p><p>Para recuperar el intent desde la primera actividad deberemos de implementar:</p><figure class="highlight"><pre><code class="language-java" data-lang="java">    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onActivityResult</span><span class="o">(</span><span class="kt">int</span> <span class="n">requestCode</span><span class="o">,</span> <span class="kt">int</span> <span class="n">resultCode</span><span class="o">,</span> <span class="nd">@Nullable</span> <span class="nc">Intent</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onActivityResult</span><span class="o">(</span><span class="n">requestCode</span><span class="o">,</span> <span class="n">resultCode</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>

        <span class="k">switch</span> <span class="o">(</span><span class="n">requestCode</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">case</span> <span class="nl">OPCION1:</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">resultCode</span> <span class="o">==</span> <span class="no">RESULT_OK</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"Intent Opción 1: "</span>
                            <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="na">getStringExtra</span><span class="o">(</span><span class="s">"tag3"</span><span class="o">),</span> <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
                <span class="o">}</span> <span class="k">else</span>
                    <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"Usuario ha cancelado"</span><span class="o">,</span> <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
                <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span></code></pre></figure><p>Observa como tenemos 3 parámetros: <code class="highlighter-rouge">requestCode</code>, <code class="highlighter-rouge">resultCode</code> y <code class="highlighter-rouge">data</code>. Corresponden respectivamente a <code class="highlighter-rouge">OPCION1</code>, <code class="highlighter-rouge">RESULT_OK</code> y al intent enviado en respuesta por la segunda actividad. En el ejemplo anterior se puede observar como podemos recuperar el contenido del intent, identificarlo y conocer el código de respuesta.</p><ul><li>Botón <code class="highlighter-rouge">Intent implícito HTTP</code>: Los intent implícitos por el contrario son más fáciles de implementar. Por ejemplo, si queremos visitar una aplicación web únicamente es necesario definir el intent implícito y enviarlo.</ul><figure class="highlight"><pre><code class="language-java" data-lang="java">        <span class="nc">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Intent</span><span class="o">();</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">setAction</span><span class="o">(</span><span class="nc">Intent</span><span class="o">.</span><span class="na">ACTION_VIEW</span><span class="o">);</span>
        <span class="c1">//Parseamos a tipo Uri (la dirección debe de empezar por http:</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="nc">Uri</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">editText</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">()));</span>
        <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span></code></pre></figure><p>Es importante definir la acción y los datos del intent para que se nos dé a elegir el tipo de aplicación correcto. La cadena de dirección (URI) deberá de comenzar por <em>http:</em>. Esto es importante debido a que indica el tipo de contenido de ese intent.</p><p>El uso es parecido al del intent explícito, pero sin definir a quién va dirigido. Será el propio sistema operativo el que le dé a elegir al usuario la opción aplicación preferida.</p><ul><li>Botón <code class="highlighter-rouge">GPS</code>: Otro ejemplo utilizando maps.</ul><figure class="highlight"><pre><code class="language-java" data-lang="java">        <span class="nc">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Intent</span><span class="o">();</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">setAction</span><span class="o">(</span><span class="nc">Intent</span><span class="o">.</span><span class="na">ACTION_VIEW</span><span class="o">);</span>

        <span class="c1">// Según lo definido en setData se abrirá una aplicación u otra</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="nc">Uri</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"geo:41.6460036,-0.8884131"</span><span class="o">));</span>
        <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span></code></pre></figure><p>En este caso, la URI definida por <code class="highlighter-rouge">setData()</code> empezará por <em>geo:</em>.</p><ul><li>Botón <code class="highlighter-rouge">Email</code>: Y por último, otro ejemplo con aplicaciones para enviar emails. Se abrirá un cliente de email con un email ya creado con los datos definidos en el intent, listo para ser enviado.</ul><figure class="highlight"><pre><code class="language-java" data-lang="java">        <span class="nc">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Intent</span><span class="o">();</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="s">"*/*"</span><span class="o">);</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="nc">Uri</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"mailto:"</span><span class="o">));</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">setAction</span><span class="o">(</span><span class="nc">Intent</span><span class="o">.</span><span class="na">ACTION_SENDTO</span><span class="o">);</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="nc">Intent</span><span class="o">.</span><span class="na">EXTRA_EMAIL</span><span class="o">,</span> <span class="k">new</span> <span class="nc">String</span><span class="o">[]{</span><span class="s">"direcasd@gads.com"</span><span class="o">,</span> <span class="s">"adsf@gfas.com"</span><span class="o">});</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="nc">Intent</span><span class="o">.</span><span class="na">EXTRA_SUBJECT</span><span class="o">,</span> <span class="s">"Asunto"</span><span class="o">);</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="nc">Intent</span><span class="o">.</span><span class="na">EXTRA_STREAM</span><span class="o">,</span> <span class="s">"Cuerpo"</span><span class="o">);</span>

        <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span></code></pre></figure><p>Hay que tener en cuenta que para enviar emails desde el dispositivo se debe de haber configurado una cuenta de Gmail previamente.</p><p>Cada intent, según la especificación, debe de construirse con unas características. Para ello existen guías que muestran los más comunes: <a href="https://developer.android.com/guide/components/intents-common?hl=es-419">https://developer.android.com/guide/components/intents-common?hl=es-419</a></p><h1 id="filtros-de-intents"> <a href="#filtros-de-intents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Filtros de intents</h1><p>Los filtros de intents ponen a nuestra aplicación en el lado contrario; como los receptores del intent, siempre que se defina en el componente un filtro de intent compatible que se ajuste a los parámetros del intent enviado. Será el usuario al que se le de la opción de seleccionar nuestra aplicación entre una lista. En nuestro ejemplo, haremos que la aplicación de fotos comparta una imagen y sea nuestra aplicación la que capture el intent y muestre la imagen.</p><p style="text-align: center;"><img src="/PMD_19-20/assets/img_post_intents/captura2.png" alt="Android" /></p><p>Pasos a seguir en el proyecto <a href="https://github.com/Manuel-Ag/PMD_19-20/tree/master/Intentfilter">https://github.com/Manuel-Ag/PMD_19-20/tree/master/Intentfilter</a> :</p><ol><li>Instala la aplicación en el dipositivo y ciérrala.<li>Realiza una foto con la aplicación de fotos del dispositivo.<li>Abre una aplicación que permita visualizar fotos y compartirlas. En nuestro ejemplo utilizaremos la aplicación <em>fotos</em>.<li>Pulsa en el incono de compartir, a continuación selecciona nuestra aplicación.</ol><p>Para implementar un filtro de intent, simplemente debemos de definir en el fichero manifiesto el filtro en un componente:</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml">        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">".MainActivity"</span><span class="nt">&gt;</span>
	    ...
            <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"android.intent.action.SEND"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"android.intent.category.DEFAULT"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;data</span> <span class="na">android:mimeType=</span><span class="s">"image/*"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/intent-filter&gt;</span>
 	    ...
        <span class="nt">&lt;/activity&gt;</span></code></pre></figure><p>Un mismo componente puede tener más de un filtro. En este ejemplo nos centraremos en el de imágenes.</p><p>Los filtros pueden tener diferentes acciones, datos o tipos de datos. Para ver la construcción de filtros más comunes puedes visitar <a href="https://developer.android.com/guide/components/intents-common?hl=es-419">https://developer.android.com/guide/components/intents-common?hl=es-419</a> y ver varios ejemplos. Entre la lista se puede encontrar el de nuestra aplicación.</p><p>De esta forma, nuestra aplicación recibirá ese intent con los datos definidos. Será nuestra responsabilidad capturarlo:</p><figure class="highlight"><pre><code class="language-java" data-lang="java">        <span class="nc">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="n">getIntent</span><span class="o">();</span>
        <span class="c1">// Acción</span>
        <span class="nc">String</span> <span class="n">action</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getAction</span><span class="o">();</span>
        <span class="c1">// Tipo mime</span>
        <span class="nc">String</span> <span class="n">type</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getType</span><span class="o">();</span>

        <span class="nc">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">"prueba"</span><span class="o">,</span> <span class="s">"Action: "</span> <span class="o">+</span> <span class="n">action</span> <span class="o">+</span> <span class="s">" Tipo: "</span> <span class="o">+</span> <span class="n">type</span><span class="o">);</span>

        <span class="c1">// Comprobamos la acción y que le tipo no es nulo</span>
        <span class="k">if</span> <span class="o">(</span><span class="nc">Intent</span><span class="o">.</span><span class="na">ACTION_SEND</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">action</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">type</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// En caso de ser texto plano (hay que definirlo en el Manifest.xml)</span>
            <span class="k">if</span> <span class="o">(</span><span class="s">"text/plain"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">type</span><span class="o">))</span> <span class="o">{</span>

            <span class="o">}</span>
            <span class="c1">// En caso de ser imagen</span>
            <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">type</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"image/"</span><span class="o">))</span> <span class="o">{</span>
                <span class="nc">ImageView</span> <span class="n">imageView</span> <span class="o">=</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">imageView</span><span class="o">);</span>
                <span class="c1">// Pasamos la dirección de la imagen</span>
                <span class="nc">Uri</span> <span class="n">imageUri</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Uri</span><span class="o">)</span> <span class="n">intent</span><span class="o">.</span><span class="na">getParcelableExtra</span><span class="o">(</span><span class="nc">Intent</span><span class="o">.</span><span class="na">EXTRA_STREAM</span><span class="o">);</span>
                <span class="n">imageView</span><span class="o">.</span><span class="na">setImageURI</span><span class="o">(</span><span class="n">imageUri</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span></code></pre></figure><p>Una vez recuperado el intent que lanzó nuestra actividad, podemos conocer la acción, el tipo, los datos, etc., para a continuación manejarlo como más convenga. En este caso, nos viene una URI con la dirección de una imagen, así que la usaremos para localizar la imágen y mostrarla en nuestra aplicación.</p><p><strong>Ver también:</strong></p><ul><li>Tipos mime: <a href="https://developer.mozilla.org/es/docs/Web/HTTP/Basics_of_HTTP/MIME_types">https://developer.mozilla.org/es/docs/Web/HTTP/Basics_of_HTTP/MIME_types</a></ul><hr><footer role="contentinfo"><p class="text-small text-grey-dk-000 mb-0"></p></footer></div></div></div></div>
